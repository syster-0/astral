name: ğŸš€ å‘å¸ƒ

on:
  workflow_dispatch:
    # inputs:
    #   version:
    #     description: 'Release version (e.g., v1.0.0)'
    #     required: true
    #     type: string

jobs:
  build:
    runs-on: ubuntu-latest

    # è°ƒæ•´ GITHUB_TOKEN çš„æƒé™
    permissions:
      contents: write  # å…è®¸å†™å…¥ä»“åº“å†…å®¹ï¼ˆä¸Šä¼ æ–‡ä»¶ï¼‰
      actions: read    # å…è®¸è¯»å–å·¥ä½œæµç¨‹

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        
      - name: ğŸ“¦ ä¸‹è½½ armeabi-v7a æ„ä»¶
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: "android-build-armv7.yaml"
          name: app-release-armeabi-v7a
          path: ./downloaded/armeabi-v7a
          search_artifacts: true
          if_no_artifact_found: warn
          
      - name: ğŸ“¦ ä¸‹è½½ arm64-v8a æ„ä»¶
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: "android-build-arm64.yaml"
          name: app-release-arm64-v8a
          path: ./downloaded/arm64-v8a
          search_artifacts: true
          if_no_artifact_found: warn
          
      - name: ğŸ“¦ ä¸‹è½½æ‰€æœ‰æ¶æ„æ„ä»¶
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: "android-build-all.yaml"
          name: app-release-all
          path: ./downloaded/all
          search_artifacts: true
          if_no_artifact_found: warn
          
      - name: ğŸ“¦ ä¸‹è½½ x86_64 æ„ä»¶
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: "android-build-x86_64.yaml"
          name: app-release-x86_64
          path: ./downloaded/x86_64
          search_artifacts: true
          if_no_artifact_found: warn
          
      - name: ğŸ“¦ ä¸‹è½½ Windows æ„ä»¶
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: "windows-build.yml"
          name: release
          path: ./downloaded/windows
          search_artifacts: true
          if_no_artifact_found: warn
          
      - name: ğŸ“ åˆ—å‡ºä¸‹è½½çš„æ–‡ä»¶
        run: |
          echo "å·²ä¸‹è½½çš„æ–‡ä»¶åˆ—è¡¨:"
          ls -la ./downloaded
          echo "armeabi-v7a æ–‡ä»¶:"
          ls -la ./downloaded/armeabi-v7a || echo "ç›®å½•ä¸å­˜åœ¨"
          echo "arm64-v8a æ–‡ä»¶:"
          ls -la ./downloaded/arm64-v8a || echo "ç›®å½•ä¸å­˜åœ¨"
          echo "æ‰€æœ‰æ¶æ„æ–‡ä»¶:"
          ls -la ./downloaded/all || echo "ç›®å½•ä¸å­˜åœ¨"
          echo "x86_64 æ–‡ä»¶:"
          ls -la ./downloaded/x86_64 || echo "ç›®å½•ä¸å­˜åœ¨"
          echo "Windows æ–‡ä»¶:"
          ls -la ./downloaded/windows || echo "ç›®å½•ä¸å­˜åœ¨"